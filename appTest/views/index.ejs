<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/head') %>
</head>

<body>
  <header>
    <%- include('./partials/header') %>
  </header>

  <main>
    <div class="jumbotron">

      <section id="menu">
        <h3>Bem vindo!</h3>
        <h5>Escolha uma opção abaixo:</h5>
        <br>
        <p>Meu Perfil</p>
        <p>Criar conta digital</p>
        <p>Listar contas à vencer</p>
        <p>Listar contas pagas</p>

        <div id="saldo">

          <button href="#" type="submit" id="view_balance" onclick="balance"> Verificar Saldo </button>
          <h5></h5>
        </div>
      </section>

    </div>


  </main>


  <%- include('./partials/footer') %>

    <!-- //SCRIPTS -->
    <!-- <script defer src=" ../public/js/balance.js"></script> -->



    <script>



      balance = () => {
        const balanceButton = document.querySelector('#view_balance')
        const divSaldo = document.querySelector('#saldo')

        balanceButton.addEventListener('click', () => {
          console.log("clicou no botao")
          button.textContent = "...Carregando"

          fetch('http://localhost:5050/account/balance', {
            method: "GET",
            headers: {
              "Content-Type": "Application/json",
              "Authorization": `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxNDc2YzBhZDdlY2Y5NzgwYWU3ZTExYiIsImlhdCI6MTYzMjY5NjgwNSwiZXhwIjoxNjMyNzgzMjA1fQ.4PSxI8EMN_FstWdD6MrGO4wpwiuqUSEuuBaKhjILXVU`
            }
          })
            .then((response) => response.json())
            .then((data) => {
              const h5 = document.createElement('h5');
              // h5.setAttribute('id', id)

              h5.innerHTML += `Total R$ ${data.total},00`;

              divSaldo.appendChild(h5)
              console.log(data.total)
              button.textContent = "Seu saldo"
            })

        })

        const balance = getBalance();
      }

      if (balance) {
        balance.then(data => {
          document.getElementById('balance').innerText = data.total;
        })
      }



    </script>
</body>

</html>